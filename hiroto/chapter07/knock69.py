'''
69. t-SNEによる可視化Permalink
ベクトル空間上の国名に関する単語ベクトルをt-SNEで可視化せよ．
'''
import pickle
from matplotlib import pyplot as plt
from sklearn.manifold import TSNE

with open('./data/country_names.pickle', mode='rb') as f1\
    , open('./data/country_vectors.pickle', mode='rb') as f2\
    , open('./data/cv_dic.pickle', mode='rb') as f3:
    country_names = pickle.load(f1)
    country_vectors = pickle.load(f2)
    #K-Meansで使ったクラスターを使う
    cluster_dic = pickle.load(f3)

#インスタンス作成
tsne = TSNE(n_components=2, random_state=0)
vecs_2d = tsne.fit_transform(country_vectors)

#国名:二次元ベクトル　の辞書
dic = {}
for idx in range(len(country_names)):
    dic[country_names[idx]] = vecs_2d[idx, :] # (116, 2)

#色指定
colors = ['blue', 'red', 'orange', 'green', 'purple']

#それぞれのクラスターに属する国のベクトルを取ってくる
def get_vecs(countries):
    vecs = []
    for country in countries:
        vecs.append(dic[country])
    return vecs
#色指定のカウンタ
color_cnt = 0
#クラスターごとに処理する
for label, countries in cluster_dic.items():
    #vecs----[vec1, vec2, ..., vecn]
    #veck.shape is 1×2
    vecs = get_vecs(countries)
    color = colors[color_cnt]
    idx = 0
    #クラスターに属する国ごとにプロット
    for country in countries:
        plt.scatter(vecs[idx][0], vecs[idx][1], marker='None', c=color)
        plt.annotate(country, (vecs[idx][0], vecs[idx][1]), c = color)
        idx += 1
    
    color_cnt += 1

plt.show()
print(vecs_2d)

'''
[[  2.0149941   -7.828156  ]
 [  0.16959499  -7.668868  ]
 [  6.161924   -10.134928  ]
 [  2.38312     -6.205415  ]
 [ -5.4602065    4.170679  ]
 [  3.187151   -10.933941  ]
 [  3.766364   -11.354165  ]
 [  8.097361    -0.8496251 ]
 [ -3.355417     0.8421079 ]
 [-11.820011    -0.35820296]
 [ -9.797337    -3.1739604 ]
 [  5.050431   -10.142216  ]
 [ -1.1308317    5.109643  ]
 [ -5.446349    -4.3425016 ]
 [ -2.3652787   -1.4145111 ]
 [  1.3685246   -4.581414  ]
 [  8.858294    -9.331775  ]
 [  7.7410035   -3.1846323 ]
 [  7.983291    -1.0545629 ]
 [  7.4653816   -9.4101305 ]
 [ -9.58657      2.7854195 ]
 [  5.473126    -3.6396923 ]
 [ -0.9734562   -9.302096  ]
 [ -9.385092    -4.48276   ]
 [ -9.488385    -5.0257587 ]
 [  3.6433756   -5.7134695 ]
 [ -5.6186376    3.1829233 ]
 [ -5.008624     3.1360192 ]
 [ -8.177101    -5.937641  ]
 [ -0.82058907  -5.738658  ]
 [  2.5375593   -0.52169   ]
 [ -5.944719    -2.8951325 ]
 [  3.3926992    1.0873575 ]
 [  0.4748703   -5.7689815 ]
 [  3.484809    -8.368552  ]
 [ -6.6283236   -1.5902231 ]
 [  3.2251308    4.156772  ]
 [  4.208645    -2.430692  ]
 [  4.919033     3.2187836 ]
 [  1.5597917  -11.985548  ]
 [ -5.8855205    1.4732753 ]
 [ -1.3711766   -8.834952  ]
 [  4.0573964   -6.298372  ]
 [ -0.8236088    5.1594377 ]
 [ -2.3439913   -3.5552456 ]
 [  2.4785833   -8.544963  ]
 [  3.792093    -9.494491  ]
 [  1.7019756   -8.271493  ]
 [  0.7233948    1.1294963 ]
 [  2.9363492   -9.67215   ]
 [ -4.728299     3.7507129 ]
 [  1.1825229   -3.7723074 ]
 [ -7.6747355   -3.0803866 ]
 [ -2.8087234   -4.4139166 ]
 [ -5.839729    -5.806596  ]
 [ -2.862998     1.3815618 ]
 [  0.20563002  -2.422021  ]
 [  4.869788     3.2016213 ]
 [  9.415648    -8.674689  ]
 [  5.737036    -9.591803  ]
 [-11.42885     -1.6091012 ]
 [  5.219658    -8.098744  ]
 [ -1.941232    -8.264714  ]
 [  3.3380609   -9.4684105 ]
 [  3.1913016    4.116725  ]
 [-10.202218    -3.368379  ]
 [ -8.981355    -1.0146455 ]
 [  8.054325    -3.4586897 ]
 [ -0.38150412  -4.7129574 ]
 [  2.012188     1.3198848 ]
 [  2.4055367  -11.936314  ]
 [ -7.449511    -5.318115  ]
 [ -0.0935882   -4.4847    ]
 [-10.727527    -4.5980945 ]
 [  6.9391346   -2.575833  ]
 [  8.346953    -9.099667  ]
 [ -6.9546337   -3.1710904 ]
 [ -2.5373175    0.41295168]
 [ -5.5333576   -1.9674975 ]
 [  6.173218    -0.43085805]
 [ -2.649264     5.5887814 ]
 [ -2.2845411    2.302452  ]
 [ -9.529886    -1.8317897 ]
 [-11.584589    -1.3579772 ]
 [  5.468063    -6.498341  ]
 [  3.016532     1.6517036 ]
 [  1.4062927  -10.464608  ]
 [  6.763674    -7.768887  ]
 [  7.144142    -8.411916  ]
 [ -2.0584614    0.17097995]
 [ -8.217063    -6.436504  ]
 [ -2.8080757   -3.5416641 ]
 [  0.6467772   -1.7948208 ]
 [  1.3733903   -9.606377  ]
 [ -5.4996676   -3.9864964 ]
 [ -9.826071    -2.0913322 ]
 [  3.9232635   -2.8449087 ]
 [ -1.0144403   -6.299564  ]
 [ -2.1283262    1.4796245 ]
 [  4.0679646   -2.4453967 ]
 [ -0.6573995   -7.3556924 ]
 [  1.3746293    1.1881729 ]
 [ -4.572463    -3.0723011 ]
 [ -8.488482    -4.140904  ]
 [  0.1816254   -6.9070997 ]
 [ -2.230369    -8.771207  ]
 [  2.285587    -0.59591115]
 [  8.234621   -10.143021  ]
 [ -5.828214     2.3722632 ]
 [ -9.046147    -4.0532565 ]
 [ -1.7641774   -0.33119458]
 [  1.8248166  -11.0747385 ]
 [  1.5643591   -0.8813191 ]
 [ -3.2404175   -9.259072  ]
 [  5.7838254   -8.8403015 ]
 [ -3.5898914   -4.4155626 ]]
'''